<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<title data-react-helmet="true">実践 4(前半) | プログラミング初心者のためのPython講座</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mtoyokura.github.io//python-koza/practice_4_1"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="実践 4(前半) | プログラミング初心者のためのPython講座"><meta data-react-helmet="true" name="description" content="概要"><meta data-react-helmet="true" property="og:description" content="概要"><link data-react-helmet="true" rel="icon" href="/python-koza/img/python-logo.png"><link data-react-helmet="true" rel="canonical" href="https://mtoyokura.github.io//python-koza/practice_4_1"><link data-react-helmet="true" rel="alternate" href="https://mtoyokura.github.io//python-koza/practice_4_1" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mtoyokura.github.io//python-koza/practice_4_1" hreflang="x-default"><link rel="stylesheet" href="/python-koza/assets/css/styles.cae43c22.css">
<link rel="preload" href="/python-koza/assets/js/runtime~main.89277667.js" as="script">
<link rel="preload" href="/python-koza/assets/js/main.86c1b929.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/python-koza/"><div class="navbar__logo"><img src="/python-koza/img/python-logo.png" alt="Python Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/python-koza/img/python-logo.png" alt="Python Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">プログラミング初心者のためのPython入門</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/python-koza/introduction">基礎講座</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/introduction">はじめに</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/stage_1">ステージ1：インタープリタ、データ型、オペレータ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/stage_2">ステージ2：関数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/stage_3">ステージ3：ブール値、条件分岐、ループ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/practice_1">実践 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/stage_4">ステージ4：関数を作る</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/stage_5">ステージ5：リスト、メソッド</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/practice_2">実践 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/practice_3">実践 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/stage_6">ステージ6：モジュール</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/python-koza/practice_4_1">実践 4(前半)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/practice_4_2">実践 4(後半)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/python-koza/closing">おわりに</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/python-koza/about_supplementary">補講</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/python-koza/installing_python">補足資料</a></div></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>実践 4(前半)</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="概要">概要<a aria-hidden="true" class="hash-link" href="#概要" title="Direct link to heading">​</a></h2><p>ついに最後の実践です。 </p><p>この実践では無償で提供されている外部モジュールを使って、ウェブサイトにある情報をエクセルに書き込むという作業を自動化してくれるプログラムを書きます。具体的には、<a href="https://www.mofa.go.jp/mofaj/gaiko/oda/sdgs/case/goal1.html" target="_blank" rel="noopener noreferrer">外務省のサイトに掲載されている</a>SDGsに取り組んでいる企業の企業名とそのリンクをエクセルのセルにそれぞれ書き込んでくれるプログラムを書きます。 </p><p>今回もなかなか難易度が高いので手順を一つ一つ解説していきながらの実践になります。 </p><p>さて、今までサイト上で使ってきたIDEであるTrinketでは外部モジュールを使用できないので、ここからの作業は各自のパソコン上で行うことになります。パソコンにPythonがインストールされてない人はインストールしましょう。インストールの手順は<a href="/python-koza/installing_python">こちら</a>で説明しています。 </p><p>ではまず、どのようなモジュールを使えば目標が達成できるかを考えます。 </p><p>あるサイトの内容を抽出し、エクセルへの書き込むところまで一貫して行ってくれるモジュールがあれば便利なのですが、おそらくそのようなものは存在しません。が、サイトの内容を抽出するモジュールと、データをエクセルに書き込んでくれるモジュールはありそうな気がしますがわかりません。 そんなときはどうするかというと、Googleで調べます。Googleで「Python サイト 保存」などで検索すると、なにやら「Requests」や「BeautifulSoup」というモジュール名がでてきますね。また、「Python エクセル」で調べると「openpyxl」というモジュールが出てきます。それぞれのモジュールを自作のコードで組み合わせることで目的が達成されそうです。 </p><p>というわけでこの実践では「Requests」、「BeautifulSoup」、「openpyxl」という3つの外部モジュールを使います。すこしだけこれらのモジュールの紹介をしたいと思います。 </p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><h3 class="anchor anchorWithStickyNavbar_31ik" id="requests">Requests<a aria-hidden="true" class="hash-link" href="#requests" title="Direct link to heading">​</a></h3><p>Requestsは、ネット上にある情報をPythonで読み込むためのモジュールです。私達は普段はGoogle ChromeやInternet Explorerといったブラウザでインターネット上にある情報にアクセスをしていますが、Requestsを使うことでPythonを通じてインターネット上にある情報にアクセスができるようになります。 </p><h3 class="anchor anchorWithStickyNavbar_31ik" id="beautifulsoup">BeautifulSoup<a aria-hidden="true" class="hash-link" href="#beautifulsoup" title="Direct link to heading">​</a></h3><p>BeautifulSoupは、Requestsなどで得られた情報を分析するツールです。私達が普段目にするサイトはHTMLという言語で表示内容や表示方法が指示されており、これに従って各ブラウザはパソコンの画面上にサイトの内容を表示します。BeautifulSoupを使うことで、Requestsを通じて得られたHTMLがどのような内容であるかの分析ができます。 </p><h3 class="anchor anchorWithStickyNavbar_31ik" id="openpyxl">openpyxl<a aria-hidden="true" class="hash-link" href="#openpyxl" title="Direct link to heading">​</a></h3><p>openpyxlは、Pythonを使ってエクセルファイルを操作するためのモジュールです。 </p></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="モジュールのインストール">モジュールのインストール<a aria-hidden="true" class="hash-link" href="#モジュールのインストール" title="Direct link to heading">​</a></h2><p>それではこれらのモジュールをインストールしましょう。 </p><p>外部モジュールのインストール方法はPythonのバージョンによって異なりますが、Pythonのバージョンが3.4以上であればpipインストールという方法が主に用いられます。 </p><p>pipインストールは、Windowsのコマンドプロンプトとよばれる画面を通じて行います。コマンドプロンプトとは、文字を使ってWindowsに指示を送る画面です。 </p><p>コマンドプロンプトの画面を開く方法はいくつかあります。<b>Windowsキー+R</b>あるいは、<b>Ctrl+Shift+Esc</b>でタスクマネージャーを開いて左上の <b>ファイル <!-- -->&gt;<!-- --> 新しいタスクの実行 </b>をクリックすることで「ファイル名を指定して実行」の画面を表示させ、ファイル名に<b>cmd</b>と入力することでコマンドプロンプトを開くことができます。 </p><img alt="runからコマンドプロンプトを実行" src="/python-koza/img/docs/practice_4_1/run_cmd.png"><p>また画面左下の<b>Windowsアイコン</b>を右クリックして<b>コマンドプロンプト(C)</b>をクリックすることでも開くことができます。 </p><img alt="タスクバーからコマンドプロンプトを実行" src="/python-koza/img/docs/practice_4_1/windows_taskbar_cmd.png"><p>コマンドプロンプトを開くと、下のような黒い背景に白文字の画面が表示されます。 </p><img alt="コマンドプロンプト1" src="/python-koza/img/docs/practice_4_1/cmd_1.png"><p>上の画像「Username」にはみなさんの場合はログインしている自分のユーザー名が書かれているはずです。 </p><p>Pythonをパソコンにインストールする際に「Pathに追加」を選択していればこの画面上に<code>pip install ○○</code>(モジュールのpipインストールの際の名前)と入力するだけで外部モジュールをインストールすることができます。モジュールの名前とpipインストールの際の名前が異なる場合があります。pipインストールの際の名前は各モジュールのホームページや、Pythonのパッケージをまとめている<a href="https://pypi.org/" target="_blank" rel="noopener noreferrer">PyPI</a>に記載されているので、確認してからインストールしましょう。 </p><p>それではまずRequestsをインストールしましょう。Requestsのpipインストールの際の名前はRが小文字になった「requests」です。下の画像のようにコマンドプロンプトの画面に <code>pip install requests</code>と入力しましょう。 </p><img alt="コマンドプロンプト3" src="/python-koza/img/docs/practice_4_1/cmd_3.png"><p>この状態でEnterキーを押せばRequestsのインストールが開始されます。 </p><img alt="Requestsのインストール" src="/python-koza/img/docs/practice_4_1/cmd_requests_installed.png"><p>上の画像のはインストールが完了した状態です。 </p><p>ついでにBeautifulSoupとopenpyxlもインストールしておきましょう。BeautifulSoupのpipインストールの際の名前は「beautifulsoup4」で、openpyxlのpipインストールの際の名前は変わらず「openpyxl」です。先程の画面に<code>pip install beautifulsoup4 openpyxl</code>というようにpip installという文字のあとに2つのモジュール名にスペースでを入れて入力してEnterキーを押すと、2つを一度にインストールすることができます。 </p><h2 class="anchor anchorWithStickyNavbar_31ik" id="モジュールの使い方--requestsbeautifulsoup編">モジュールの使い方  ～Requests、BeautifulSoup編～<a aria-hidden="true" class="hash-link" href="#モジュールの使い方--requestsbeautifulsoup編" title="Direct link to heading">​</a></h2><p>外部モジュールを使うためには、まずそのモジュールの使い方を知る必要があります。モジュールの使い方に関する文書は開発者によって用意されていますが、大抵の場合英語です。幸いRequestsとBeautifulSoupに関する文書は有志による日本語訳が存在します。 </p><p>Requestsの使い方: <a href="http://jp.python-Requests.org/en/latest/" target="_blank" rel="noopener noreferrer"><a href="http://jp.python-Requests.org/en/latest/" target="_blank" rel="noopener noreferrer">http://jp.python-Requests.org/en/latest/</a></a></p><p>BeautifulSoupの使い方: <a href="http://kondou.com/BS4/" target="_blank" rel="noopener noreferrer"><a href="http://kondou.com/BS4/" target="_blank" rel="noopener noreferrer">http://kondou.com/BS4/</a></a></p><p>大抵の場合各モジュールの基本的な使い方に関しては具体的なコードと共にに紹介されています。いままで使ったことのないモジュールを使いたい場合は、文書で用意された手順に従って実際にモジュールを使ってみることが大事です。 </p><p>本来は各モジュールの基本的な使い方を紹介するべきなのですが、長くなってしまうのでここではこの実践で使う機能のみを解説します。 </p><p>まずはRequestsとBeautifulSoupの機能をIDLEの対話モードのインタープリタを使ってみていきます。 </p><p>それではIDLEの対話モードのインタープリタに以下のコードを書いてみてください。 </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; import requests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; from bs4 import BeautifulSoup</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; url = &#x27;https://www.mofa.go.jp/mofaj/gaiko/oda/sdgs/case/goal1.html&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; result = requests.get(url)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; pagecontent = result.content</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; soup = BeautifulSoup(pagecontent, &#x27;html.parser&#x27;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>画面からはわかりませんがこの6行でかなりの処理が行われています。 </p><p>1行目ではrequestsのモジュールをインポートしています。 </p><p>2行目では、BeautifulSoupをインポートしています。<code>from bs4 import BeautifulSoup</code>となっているのは、BeautifulSoupというモジュールはbs4というパッケージの中に存在しているからです。 </p><p>3行目では、「url」という変数にurlとなる文字列として登録しています。urlに指定しているのは総務省JAPAN SDGs Action Platformの<a href="https://www.mofa.go.jp/mofaj/gaiko/oda/sdgs/case/goal1.html" target="_blank" rel="noopener noreferrer">「取組事例 1: 貧困をなくそう」</a>です。 </p><p>4行目では、Requestsの<code>get()</code>メソッドを使ってurl先の情報を入手しています。<code>get()</code>メソッドの引数にはurlの文字列を入れます。このメソッドを実行すると、url先の情報は<code>result.content</code>でアクセスが可能となります。 </p><p>5行目では、4行目で得たurl先の情報である<code>result.content</code>のうち、HTMLに該当する部分を「pagecontent」という変数に入れています。 </p><p>6行目ではbs4の<code>BeautifulSoup()</code>メソッドを使って「pagecontent」のHTMLを要素ごとにパース(解析)しています。<code>BeautifulSoup()</code>メソッドの1つ目の引数にHTMLを、2つ目の引数にはそのHTMLを解析するためのパーサー(構文解析器)の種類を入れます。パーサーの種類については今回の実践においては気にする必要はありません。今回はPythonに標準搭載されている<code>html.parser</code>を使います。 </p><p>続いてインタープリタに </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; print(soup.prettify())</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>と入力してエンターを押すと、BeautifulSoupによって各要素ごとにきれいに分解され、見やすくされたHTMLの内容を見ることができます。 </p><p>下は<code>print(soup.prettify())</code>で得られたHTMLの一部を抜き取ったものです。 </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/head&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> &lt;body id=&quot;case&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;div id=&quot;container&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &lt;div id=&quot;head&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;div class=&quot;inner&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &lt;div class=&quot;tool&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &lt;div class=&quot;tool-link&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       &lt;ul class=&quot;link_border&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;li class=&quot;pc_only&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;a href=&quot;#main&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          本文へ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;/a&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;/li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;li lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;a href=&quot;https://www.mofa.go.jp/policy/oda/page22e_000793.html&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          English</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;/a&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;/li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------(中略)--------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &lt;div id=&quot;main&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;div class=&quot;inner&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &lt;div id=&quot;main_contents&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &lt;div class=&quot;section&quot; id=&quot;case_main&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       &lt;div id=&quot;goal_1&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;h1 class=&quot;case_h&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;span&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          取組事例</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;/span&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;span&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          1: 貧困をなくそう</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;/span&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;/h1&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;ul class=&quot;c_links&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;a href=&quot;#c1&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           あ行</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;/a&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;/li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------(中略)--------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;div class=&quot;kana_line&quot; id=&quot;c1&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;h2&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          あ行</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;/h2&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;ul&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &lt;a class=&quot;exlink&quot; href=&quot;https://www.itoki.jp/topics/solution/nona-carbon-offset.html&quot; target=&quot;_blank&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            株式会社イトーキ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &lt;/a&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;/li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;/ul&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;/div&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;div class=&quot;kana_line&quot; id=&quot;c2&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;h2&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          か行</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;/h2&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;ul&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &lt;a class=&quot;exlink&quot; href=&quot;http://www.city.kisarazu.lg.jp/12,66100,24,157.html&quot; target=&quot;_blank&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            千葉県木更津市消費生活センター</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &lt;/a&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;/li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &lt;a class=&quot;exlink&quot; href=&quot;https://www.jircas.go.jp/ja/about/sdgs&quot; target=&quot;_blank&quot;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            国立研究開発法人国際農林水産業研究センター（国際農研）</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &lt;/a&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &lt;/li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &lt;/ul&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &lt;/div&gt;&lt;/pre&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>(注: 上記のHTMLは2018/8/10時点での外務省作成のJAPAN SDGs Action Platformの<a href="https://www.mofa.go.jp/mofaj/gaiko/oda/sdgs/case/goal1.html" target="_blank" rel="noopener noreferrer">「取組事例 1: 貧困をなくそう」</a>のソースコードを一部抜き取ったものです。) </p><p>ここで、HTMLについて少し説明をしておきます。</p><p>HTMLはタグと呼ばれるもので区切られています。<b>&lt;<!-- -->&gt;</b>が区分の始まりを表し、<b>&lt;<!-- -->/<!-- -->&gt;</b>がその区分の終わりを表します。<b>&lt;<!-- -->&gt;</b>の中身は、最初にタグの名前(区分の名前)、次にそのタグの属性(文字の色などの情報)が書かれています。上のHTMLを見ると、取組事例はすべて<b>&lt;<!-- -->div id=&quot;goal_1&quot;<!-- -->&gt;</b>の区分に記載されていることがわかります。<b>&lt;<!-- -->div id=&quot;goal_1&quot;<!-- -->&gt;</b>は、id属性が<b>&quot;goal_1&quot;</b>である<b>div</b>というタグであることを指します。この<b>&lt;<!-- -->div id=&quot;goal_1&quot;<!-- -->&gt;</b>の区分の中を見ると、各取組事例とurlは<b>&lt;<!-- -->a<!-- -->&gt;</b>というタグ名の区分に含まれていることもわかります。 </p><p>これらのタグを頼りに今度はBeautifulSoupを使ってでリンクの部分だけを抽出していきます。さきほどの対話モードのインタープリタの続きに次のコードを入力しましょう。 </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; soup_div = soup.find(&#x27;div&#x27;, {&#x27;id&#x27;: &#x27;goal_1&#x27;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; list_of_links = soup_div.find_all(&#x27;a&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; list_of_links[10].text</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;千葉県木更津市消費生活センター&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; list_of_links[10].get(&#x27;href&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;http://www.city.kisarazu.lg.jp/12,66100,24,157.html&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>1行目では、BeautifulSoupの<code>find()</code>メソッドでHTMLから、最初に現れる「<b>id=&quot;goal_1&quot;</b>」である<b>&lt;<!-- -->div<!-- -->&gt;</b>タグを探し出し、その中身を抽出し、「soup_div」という変数に入れています。 </p><p>2行目では、BeautifulSoupの<code>find_all()</code>メソッドで先程抽出した「soup_div」の中身からさらに<b>&lt;<!-- -->a<!-- -->&gt;</b>タグの部分のみをすべて抽出し、「list_of_links」という変数に入れています。<code>find_all()</code>メソッドで抽出された内容はリスト型データとして記憶されます。 </p><p>3行目では「list_of_links」の11番目の要素のテキストの部分、すなわち取組事例を行っている団体名の部分を取得することを指示しています。 </p><p>4行目では3行目の結果が返されています。2018/8/10現在、「list_of_links」の11番目の要素は「千葉県木更津市消費生活センター」のようです。 </p><p>5行目では、BeautifulSoupの<code>get()</code>メソッドで「list_of_links<!-- -->[10]<!-- -->」内の<b>href</b>属性の中身、つまりurlを抽出することを指示しています。 </p><p>6行目では5行目の結果が返されています。 </p><p>以上がRequestsとBeautifulSoupの、最終的に書くプログラムで使う機能の紹介でした。 </p><p>BeautifulSoupを使うにあたっては、HTMLがどのように書かれているかの知識もある程度必要だったので、HTMLに馴染みのない人はちょっと大変だったかもしれません。 </p><p>後半ではopenpyxlの機能についてみていき、RequestsとBeautifulSoupと組み合わせて実際にプログラムを書いていきます。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/MToyokura/python-koza/tree/master/docs/practice_4_1.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/python-koza/stage_6"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->ステージ6：モジュール</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/python-koza/practice_4_2"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">実践 4(後半)<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概要" class="table-of-contents__link toc-highlight">概要</a></li><li><a href="#モジュールのインストール" class="table-of-contents__link toc-highlight">モジュールのインストール</a></li><li><a href="#モジュールの使い方--requestsbeautifulsoup編" class="table-of-contents__link toc-highlight">モジュールの使い方  ～Requests、BeautifulSoup編～</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright"><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.ja"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a><br>注があるものを除いて、<span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">プログラミング初心者のためのPython入門</span> は<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.ja">クリエイティブ・コモンズ 表示 - 継承 4.0 国際 ライセンス</a>の下で提供されています。<br>制作： M. Toyokura and Y. Kiuchi</div></div></div></footer></div>
<script src="/python-koza/assets/js/runtime~main.89277667.js"></script>
<script src="/python-koza/assets/js/main.86c1b929.js"></script>
</body>
</html>